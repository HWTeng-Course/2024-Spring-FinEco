---
title: "HW_ch03.31.d"
output: html_document
date: "2024-03-20"
---
#### This homework is written by 黃子騏 (312707036)
### (d)
**Question:**\
Construct a 90% interval estimate for the expected number of cans sold in a week when the 
price per can is 70 cents.

**Ans:**\
To estimate $E(Y_i)$, one needs to calculate $\hat{Y_i}$ first. We start with the formula that $\hat{Y_i}$ = $\hat{\beta_1}$ + $\hat{\beta_2}$$X_0$. Given $X_0$ = 70 and based on the results in part(c), we can obtain $\hat{Y_i}$ roughly equals to 10,302.9. Also, the pivot statistic follows a t-distribution and the standard error of $\hat{Y_i}$ roughly equals 1,001.231. Therefore, we can construct a 90% interval estimate by using $\hat{Y_i}$$\pm$$t_{0.05}(50)$**SE**($\hat{Y_i}$) to get [8,624.934, 11,980.87].
```{r}
data_tuna <- read.csv('C:/Users/zxc00/Desktop/tuna.csv')
library(dplyr)
data_tuna_a <- data_tuna%>%mutate(week = 1:52)
data_tuna_b <- data_tuna_a%>%mutate(price1 = 100*apr1)
reg_c <- lm(sal1 ~ price1, data = data_tuna_b)
summary(reg_c)
sreg_c <- summary(reg_c)
yi_hat <- coef(reg_c)[[1]]+coef(reg_c)[[2]]*70
yi_hat
alpha_d <- 0.1
tc_d <- qt(1 - alpha_d/2, 50)
sse_d <- sum(resid(reg_c)^2)
#mean of price1 = 78.25
#summary(data_tuna_b$price1)
mse_d <- sse_d/50
sxx_d <- sum((data_tuna_b$price1-78.25)^2)
se_yi_hat_d <- sqrt(mse_d*(1/52+(70-78.25)^2/sxx_d))
upper_bound <- yi_hat + tc_d*se_yi_hat_d 
lower_bound <- yi_hat - tc_d*se_yi_hat_d 
upper_bound
lower_bound
```